<!doctype html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<title>Neighborhood Map | London</title>
		<link href='https://fonts.googleapis.com/css?family=Roboto+Slab:300' rel='stylesheet' type='text/css'>
		<link rel="stylesheet" href="css/bootstrap.min.css" />
		<link rel="stylesheet" href="font-awesome-4.6.3/css/font-awesome.min.css">
		<link rel="stylesheet" href="css/main.css" />
	</head>

	<body>

		<nav id="drawer" class="nav col-sm-3">
			<h2 class="nav__header text-center" style="padding-top: 10px;" data-bind="text: city"></h2>
			<form class="nav__filter form-inline">
				<input type="text" class="col-sm-8 nav__filter__input form-control" id="filter" />
				<button type="submit" class="col-sm-4 nav__filter__filter-btn"><i class="fa fa-filter" aria-hidden="true"></i> Filter</button>
			</form>
      <ul class="nav__list" data-bind="foreach: placeList">
        <li class="nav__item" data-bind="text: title"></li>
      </ul>
    </nav>

		<div class="col-sm-9 main" style="height: 100%;">
			<div class="header col-sm-12">
				<button class="menu-btn">
					<i class="fa fa-bars menu-icon" aria-hidden="true"></i>
				</button>
			</div>

			<div id="map" class="col-sm-12"></div>
		</div>

		<!-- Google Maps API and Places library. -->
    <script async src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBNGEZl6rYqobrTonsMhnYhnnxl3rC07bk&libraries=places&callback=initMap"></script>

		<script>
			var map;
			var markers = [];
			var marker;
			function initMap() {
				map = new google.maps.Map(document.getElementById('map'), {
					center: {lat: 51.515083, lng: -0.122462},
					zoom: 13
				});
// NEW NEW START START
				var infowindow = new google.maps.InfoWindow();
				var service = new google.maps.places.PlacesService(map);

				for (var i = 0; i < initialPlaces.length; i++){
					marker = new google.maps.Marker({
						position: {lat: initialPlaces[i].lat, lng: initialPlaces[i].lng},
						title: initialPlaces[i].title,
						id: initialPlaces[i].placeId,
            map: map,
            animation: google.maps.Animation.DROP
					});
					markers.push(marker);
				}

				markers.forEach(function(location){
					service.getDetails({
		        placeId: location.id
	        }, function(place, status) {
          	if (status === google.maps.places.PlacesServiceStatus.OK) {
							google.maps.event.addListener(location, 'click', function() {
	              infowindow.setContent('<div><strong>' + place.name + '</strong><br>' +
	                'Place ID: ' + place.place_id + '<br>' +
	                place.formatted_address + '</div>');
	              infowindow.open(map, this);
	            });
						}
					});
				});
			}
// NEW NEW END END

				// initialPlaces.forEach(function(place){
				// 	window.setTimeout(function() {
	      //     markers.push(new google.maps.Marker({
	      //       position: {lat: place.lat, lng: place.lng},
				// 			title: place.title,
	      //       map: map,
	      //       animation: google.maps.Animation.DROP
	      //     }));
	      //   }, i++ * 200);
				// });
			// }
		</script>

		<script src="js/lib/jquery.js"></script>
		<script src="js/lib/knockout-3.2.0.js"></script>
		<script src="js/app.js"></script>
	</body>

</html>
